<!DOCTYPE html>
<html lang="en">
<head>
     <meta charset="UTF-8">
    <title>测试报告</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="/static/mine/lib/layui/css/layui.css">
    <link rel="stylesheet" href="/static/mine/css/scroll-bar.css">
    <link rel="stylesheet" href="/static/mine/css/sub-page.css">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_693759_wytlyqhtdtj1nhfr.css">
</head>
<body>
<div class="ok-body">
    <div class="ok-body-breadcrumb">
            <span class="layui-breadcrumb">
                <a><cite>PTS管理</cite></a>
				<a><cite>测试报告</cite></a>
            </span>
    </div>
    <div class="layui-form-item">
            <label class="layui-form-label">场景名</label>
            <div class="layui-input-inline">
                <input type="text" name="filename" placeholder="请输入场景名" autocomplete="off" class="layui-input" >
            </div>
             <a class="layui-btn layui-btn-small" href="javascript:location.replace(location.href);" title="刷新" style="float: right">
                <i class="layui-icon layui-icon-refresh"></i>
             </a>
            <button class="layui-btn"  style="float: right" id="viewLog">查看采样</button>
            <button class="layui-btn"  style="float: right">报告导出</button>
    </div>
    <div class="layui-form-item">
            <label class="layui-form-label">执行时间</label>
            <div class="layui-input-inline">
                <input type="text" name="filename" placeholder="请输入场景名" autocomplete="off" class="layui-input" >
            </div>
    </div>
    <fieldset class="layui-elem-field">
        <legend>数据统计</legend>
        <div class="layui-row layui-col-space10 layui-row-margin">
            <div class="layui-col-md2">
                <div class="md2-sub2">
                    <span>100%</span>
                    <cite>成功率</cite>
                </div>
            </div>
            <div class="layui-col-md2">
                <div class="md2-sub2">
                    <span>100</span>
                    <cite>配置最大并发</cite>
                </div>
            </div>
            <div class="layui-col-md2">
                <div class="md2-sub2">
                     <span>1000</span>
                    <cite>TPS（/s）</cite>
                </div>
            </div>
            <div class="layui-col-md2">
                <div class="md2-sub2">
                    <span>71</span>
                    <cite>成功RT AVG（ms）</cite>
                </div>
            </div>
            <div class="layui-col-md2">
                <div class="md2-sub2">
                    <span>0</span>
                    <cite>成功RT AVG（ms）</cite>
                </div>
            </div>
            <div class="layui-col-md2">
                <div class="md2-sub2">
                    <span>100000</span>
                    <cite>总请求数</cite>
                </div>
            </div>
        </div>
    </fieldset>
    <div class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief">
          <ul class="layui-tab-title">
            <li class="layui-this">场景详情</li>
            <li>JMeter日志</li>
          </ul>
          <div class="layui-tab-content" style="height: 100px;">
            <div class="layui-tab-item layui-show">
                <div class="layui-fluid">
                     <div class="layui-row layui-col-space10">
                         <div class="layui-col-md2">
                               <div class="layui-card">
                                   <div class="layui-card-body" style="min-height: 500px" id="projectName">
                                           <input  type='hidden' class='layui-input'  name='id' id='caseId' value='{{ caseId }}'>
                                   </div>
                                </div>
                        </div>
                        <div class="layui-col-md10">
                            <div class="layui-card">
                                <div class="layui-card-body" style="min-height: 450px">
                                    <!--数据表格-->
{#                                     <table class="layui-hide" id="tableId" lay-filter="tableFilter"></table>#}
                                </div>
                            </div>
                        </div>
                     </div>

                </div>
            </div>

            <div class="layui-tab-item">
                <!--模糊搜索区域-->
                <div class="layui-row">
                    <form class="layui-form layui-col-md12 layui-form-pane ok-form">
                        <div class="layui-form-item">
                            <label class="layui-form-label">施压机ID</label>
                            <div class="layui-input-inline ">
                                <button class="layui-btn layui-btn-radius">施压机0</button>
                            </div>
                        </div>
                        <div class="layui-form-item">
                                <label class="layui-form-label">日志级别</label>
                                <div class="layui-input-inline ">
                                    <select name="logLevel" id="logLevel">
                                        <option value="0">全部</option>
                                        <option value="1">INFO</option>
                                        <option value="2">WARN</option>
                                        <option value="3">ERROR</option>
                                    </select>
                                </div>
                                <label class="layui-form-label">时间范围</label>
                                <div class="layui-input-inline">
                                    <input type="text" name="date" id="date1" autocomplete="off" placeholder="开始日期" class="layui-input">
                                 </div>
                                <div class="layui-input-inline">
                                    <input type="text" name="date" id="date2" autocomplete="off" placeholder="结束日期" class="layui-input">
                                 </div>
                                <label class="layui-form-label">施压线程</label>
                                <div class="layui-input-inline">
                                    <input type="text"  autocomplete="off" placeholder="请输入线程名" class="layui-input">
                                 </div>
                                <a class="layui-btn" data-type="reload" lay-filter="search">
                                     <i class="layui-icon layui-icon-search"></i>
                                </a>
                        </div>
                    </form>
                </div>
                <!--数据表格-->
                <okToolbar>
                    <a class="layui-btn" id="sceneAdd" href="javascript:location.href='/pts/sceneAdd/'">
                        <i class="layui-icon">&#xe61f;</i>加载更多
                    </a>
                    <span>共有数据：<i id="countNum"></i> 条</span>
                </okToolbar>
                <ul class="flow-default" id="jmeterLogs"></ul>
            </div>
        </div>
    </div>
</div>
<!--js逻辑-->
<script src="/static/mine/lib/layui/layui.js"></script>
<script src="/static/mine/lib/nprogress/nprogress.js"></script>
<script>
      NProgress.start();
      window.onload = function () {
        NProgress.done();
    };
    layui.use(['element', 'form', 'jquery', 'laydate','upload','table','flow'], function () {
        var element = layui.element;
        var table = layui.table;
        var form = layui.form;
        var $ = layui.jquery;
        var laydate = layui.laydate;
        var upload = layui.upload;
        var flow = layui.flow;

        laydate.render({
            elem: '#date1'
            ,type: 'datetime'
             });
        laydate.render({
            elem: '#date2'
            ,type: 'datetime'
             });

        flow.load({
              elem: '#jmeterLogs' //指定列表容器
              ,done: function(page, next){ //到达临界点（默认滚动触发），触发下一页
                var lis = [];
                //以jQuery的Ajax请求为例，请求下一页数据
                $.get('/allGoods/?page='+page, function(res){
                        layui.each(res.data, function(index, item){
                          lis.push('<a href="/curExam/'+item.id+'"><li class="layui-btn" data-id="'+item.id+'">'+ item.name +'</li></a>');
                        });

                        //执行下一页渲染，第二参数为：满足“加载更多”的条件，即后面仍有分页
                        //pages为Ajax返回的总页数，只有当前页小于总页数的情况下，才会继续出现加载更多
                        next(lis.join(''), page < res.last_page);
                });
              }
          });

        $("#viewLog").click(function () {
            layer.open({
                title: '查看采样日志',
                type: 2,
                shade: false,
                maxmin: true,
                shade: 0.5,
                anim: 4,
                area: ['90%', '80%'],
                content: '/pts/report_samplerLog/',
                zIndex: layer.zIndex,
                // skin: 'layui-layer-molv',
                end: function () {
                    $(".layui-laypage-btn")[0].click();
                }
            });
        })
     })

</script>
</body>
</html>